<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üêÑ Livestock Monitor</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a2e;
            color: #fff;
            margin: 20px;
        }
        
        h1 {
            text-align: center;
        }
        
        .container {
            max-width: 1200px;
            margin: auto;
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
        }
        
        #video {
            width: 100%;
            background: #000;
            border-radius: 8px;
        }
        
        .metrics {
            display: grid;
            gap: 15px;
        }
        
        .card {
            background: #2a2a4e;
            padding: 20px;
            text-align: center;
            border-radius: 8px;
        }
        
        .value {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .label {
            opacity: 0.7;
            text-transform: uppercase;
        }
        
        .total { color: #4CAF50; }
        .cows { color: #FFC107; }
        .pigs { color: #E91E63; }
        .sheep { color: #2196F3; }
        
        .alert {
            background: rgba(244, 67, 54, 0.2);
            border-left: 4px solid #f44336;
            padding: 15px;
            margin: 20px 0;
            display: none;
        }
        
        .alert.show { display: block; }
        
        .status {
            text-align: center;
            padding: 10px;
            background: rgba(76, 175, 80, 0.2);
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .status.offline {
            background: rgba(244, 67, 54, 0.2);
        }
    </style>
</head>
<body>
    <h1>üêÑ Livestock Monitoring System</h1>
    
    <div class="status" id="status">System Online - FPS: <span id="fps">0</span></div>
    
    <div class="container">
        <!-- Video Feed -->
        <div>
            <img id="video" src="" alt="Camera Feed">
        </div>
        
        <!-- Metrics -->
        <div class="metrics">
            <div class="card">
                <div>üìä</div>
                <div class="value total" id="total">0</div>
                <div class="label">Total</div>
            </div>
            
            <div class="card">
                <div>üêÑ</div>
                <div class="value cows" id="cows">0</div>
                <div class="label">Cows</div>
            </div>
            
            <div class="card">
                <div>üê∑</div>
                <div class="value pigs" id="pigs">0</div>
                <div class="label">Pigs</div>
            </div>
            
            <div class="card">
                <div>üêë</div>
                <div class="value sheep" id="sheep">0</div>
                <div class="label">Sheep</div>
            </div>
        </div>
    </div>
    
    <div class="alert" id="alert">‚ö†Ô∏è <span id="alert-text"></span></div>
    
    <script>
        // Get camera IP from URL or use default
        const cameraIP = new URLSearchParams(window.location.search).get('ip') || '192.168.1.100';
        
        // Set video source
        document.getElementById('video').src = `http://${cameraIP}:8080/video`;
        
        // Update metrics every second
        setInterval(async () => {
            try {
                const response = await fetch('/metrics.json');
                const data = await response.json();
                
                // Update values
                document.getElementById('total').textContent = data.total || 0;
                document.getElementById('cows').textContent = data.cows || 0;
                document.getElementById('pigs').textContent = data.pigs || 0;
                document.getElementById('sheep').textContent = data.sheep || 0;
                document.getElementById('fps').textContent = Math.round(data.fps || 0);
                
                // Status
                document.getElementById('status').className = 'status';
                
                // Alerts
                const alert = document.getElementById('alert');
                if (data.alerts && data.alerts.length > 0) {
                    alert.className = 'alert show';
                    document.getElementById('alert-text').textContent = data.alerts[0];
                } else {
                    alert.className = 'alert';
                }
                
            } catch (error) {
                document.getElementById('status').className = 'status offline';
                document.getElementById('status').innerHTML = 'System Offline';
            }
        }, 1000);
    </script>
</body>
</html>